import re

# Function to convert a payload to a regular expression
def convert_to_regex(payload):
    # Escape all special characters to ensure the payload is treated as a literal string in regex
    escaped_payload = re.escape(payload)
    # Replace spaces with \s+ to allow for varying amounts of whitespace
    regex_payload = re.sub(r'\\s+', r'\\s+', escaped_payload)
    return regex_payload

# Read the payloads from the file
with open('payloads.txt', 'r') as file:
    payloads = file.readlines()

# Convert each payload to a regular expression
regex_payloads = [convert_to_regex(payload.strip()) for payload in payloads]

# Save the regular expressions to a new file
with open('regex_payloads.txt', 'w') as file:
    for regex_payload in regex_payloads:
        file.write(regex_payload + '\n')

# Print out the regular expressions
for regex_payload in regex_payloads:
    print(regex_payload)
