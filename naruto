from lib.helper.helper import *
from random import randint
from bs4 import BeautifulSoup
from urllib.parse import urljoin, urlparse, parse_qs, urlencode
from lib.helper.Log import *
from requests.packages.urllib3.exceptions import InsecureRequestWarning
import os

requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

class core:
    
    @classmethod
    def load_payloads(cls, filename):
        filepath = os.path.join(os.path.dirname(__file__), filename)
        with open(filepath, 'r') as file:
            return [line.strip() for line in file.readlines()]
    
    @classmethod
    def generate(cls, eff):
        FUNCTION = cls.load_payloads('payload1.txt')  # Menggunakan payload1.txt
        if eff == 1:
            return "<script/>" + FUNCTION[randint(0, len(FUNCTION) - 1)] + "<\script\>"
        elif eff == 2:
            return "<\script/>" + FUNCTION[randint(0, len(FUNCTION) - 1)] + "<\\script>"
        elif eff == 3:
            return "<\script\> " + FUNCTION[randint(0, len(FUNCTION) - 1)] + "<//script>"
        elif eff == 4:
            return "<script>" + FUNCTION[randint(0, len(FUNCTION) - 1)] + "<\script/>"
        elif eff == 5:
            return "<script>" + FUNCTION[randint(0, len(FUNCTION) - 1)] + "<//script>"
        elif eff == 6:
            return "<script>" + FUNCTION[randint(0, len(FUNCTION) - 1)] + "</script>"

    # Metode lain tetap sama...
